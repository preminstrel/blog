<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  
  <meta name="author" content="Hanshi Sun">

  
  
  <meta name="description" content="最近科研要用到 CycleGAN，借此机会，便对 GAN(Generative Adversarial Networks) 进行一个学习。Ian Goodfellow 大牛的 Generative Adversarial Networks（arxiv：https://arxiv">
  

  
  <link rel="icon" href="https://preminstrel.github.io/blog/favicon.ico">

  
  
  <meta name="keywords" content=" hugo  latex  theme ">
  

  
  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css"
  integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
  integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js"
  integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '\\[', right: '\\]', display: true },
        { left: '$', right: '$', display: false },
        { left: '\\(', right: '\\)', display: false }
      ],
      ignoredTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'option'],
      throwOnError: false
    });
  });
</script>


  

  
  <meta property="og:title" content="Introduction to GAN" />
<meta property="og:description" content="最近科研要用到 CycleGAN，借此机会，便对 GAN(Generative Adversarial Networks) 进行一个学习。Ian Goodfellow 大牛的 Generative Adversarial Networks（arxiv：https://arxiv" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://preminstrel.github.io/blog/post/2022/01/06/introduction-to-gan/" />
<meta property="article:published_time" content="2022-01-06T23:12:33+08:00" />
<meta property="article:modified_time" content="2022-01-09T00:00:00+00:00" />


  
  <link rel="canonical" href="https://preminstrel.github.io/blog/post/2022/01/06/introduction-to-gan/">

  
  
  <meta itemprop="name" content="Introduction to GAN">
<meta itemprop="description" content="最近科研要用到 CycleGAN，借此机会，便对 GAN(Generative Adversarial Networks) 进行一个学习。Ian Goodfellow 大牛的 Generative Adversarial Networks（arxiv：https://arxiv">
<meta itemprop="datePublished" content="2022-01-06T23:12:33&#43;08:00" />
<meta itemprop="dateModified" content="2022-01-09T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1063">



<meta itemprop="keywords" content="GAN,Deep Learning," />

  
  <link media="screen" rel="stylesheet" href='https://preminstrel.github.io/blog/css/common.css'>
  <link media="screen" rel="stylesheet" href='https://preminstrel.github.io/blog/css/content.css'>

  
  
  <title>Introduction to GAN - Blog de Preminstrel</title>
  

  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction to GAN"/>
<meta name="twitter:description" content="最近科研要用到 CycleGAN，借此机会，便对 GAN(Generative Adversarial Networks) 进行一个学习。Ian Goodfellow 大牛的 Generative Adversarial Networks（arxiv：https://arxiv"/>


  
<link rel="stylesheet" href='https://preminstrel.github.io/blog/css/single.css'>

</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://preminstrel.github.io/blog/">Blog de Preminstrel</a>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      <a class="link" href="/blog/">Post</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/blog/post/">Archives</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/blog/categories/">Categories</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/blog/about/">About</a>
    </span>
    
  </nav>
</header>

    
<main id="main" class="post">
  
  
  <h1>Introduction to GAN</h1>
  
  <div>
    <center>
    2022-01-06 | [<a class="link" href='https://preminstrel.github.io/blog/categories/gan'>GAN</a>]
    </center>
  </div>

  <div>
    <b>Keywords: </b>
    
    <a class="link" href='https://preminstrel.github.io/blog/tags/gan'>#GAN</a>
    
    <a class="link" href='https://preminstrel.github.io/blog/tags/deep-learning'>#Deep Learning</a>
    
  </div>
  
  
  
  <details>
    <summary>
      <b>Table of Contents</b>
    </summary>
    <div class="toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#basic-theory">Basic Theory</a></li>
    <li><a href="#formula">Formula</a></li>
    <li><a href="#algorithm">Algorithm</a></li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav></div>
  </details>
  
  
  <article class="content">
    
    <p>最近科研要用到 CycleGAN，借此机会，便对 <em><strong>GAN(Generative Adversarial Networks)</strong></em> 进行一个学习。Ian Goodfellow 大牛的 Generative Adversarial Networks（arxiv：<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1406.2661">https://arxiv.org/abs/1406.2661</a>），是这个领域的开天辟地之作。就像 Yann LeCun 所说的，Adversarial training is the coolest thing since sliced bread.</p>
<h2 id="basic-theory">Basic Theory</h2>
<p>这里用生成图片为例对GAN的原理进行说明。假设我们有两个网络，<em><strong>G(Generator)</strong></em> 和 <em><strong>D(Discriminator)</strong></em>，它们的功能分别是：</p>
<ul>
<li>$G$ 是一个生成图片的网络，它接收一个随机的噪声 $z$，通过这个噪声生成图片，记做 $G(z)$。其输出是一个 vector。</li>
<li>$D$ 是一个判别网络，判别一张图片是不是“真实的”。它的输入参数是 $x$，$x$ 代表一张图片，输出 $D(x)$ 代表 $x$ 为真实图片的概率，如果为 1，就代表 100% 是真实的图片，而输出为 0，就代表不可能是真实的图片。其输出是一个 scalar。</li>
</ul>
<p>在训练过程中，<strong>生成网络 $G$ 的目标就是尽量生成真实的图片去欺骗判别网络 $D$。而 $D$ 的目标就是尽量把 $G$ 生成的图片和真实的图片分别开来。</strong> 这样，$G$ 和 $D$ 构成了一个动态的“博弈过程”。最后博弈的结果是：<strong>在最理想的状态下，</strong> $G$ 可以生成足以“以假乱真”的图片 $G(z)$。对于 $D$ 来说，它难以判定 $G$ 生成的图片究竟是不是真实的，因此 $D(G(z)) = 0.5$。这样，我们就成功地得到了一个生成式的模型 $G$，它可以用来生成图片。</p>
<div align=center>
<a href="https://sm.ms/image/5BDQFhomMHzyfLs" target="_blank"><img src="https://s2.loli.net/2022/04/14/5BDQFhomMHzyfLs.png" width = "600px"></a>
</div>
<h2 id="formula">Formula</h2>
<p>以上只是大致说了一下 GAN 的核心原理，如何用数学语言描述呢？这里直接摘录论文里的公式：</p>
<p>$$\min_{G} \max_{D} V(D, G)=\mathbb{E}_{\boldsymbol{x} \sim p_{\text {data }}(\boldsymbol{x})}[\log D(\boldsymbol{x})]+\mathbb{E}_{\boldsymbol{z} \sim p_{\boldsymbol{z}}(\boldsymbol{z})}[\log (1-D(G(\boldsymbol{z})))]$$</p>
<p>公式中：</p>
<ul>
<li>整个式子由两项构成。$x$ 表示真实图片，$z$  表示输入 $G$ 网络的噪声，而 $G(z)$ 表示 $G$ 网络生成的图片。</li>
<li>$D(x)$ 表示 $D$ 网络判断<strong class=chinese>真实图片是否真实</strong>的概率（因为 $x$ 就是真实的，所以对于 $D$ 来说，这个值越接近 1 越好）。而 $D(G(z))$ 是 <strong>$D$ 网络判断 $G$ 生成的图片的是否真实的概率。</strong></li>
<li>$G$ 的目的：上面提到过，$D(G(z))$ 是<strong>$D$ 网络判断 $G$ 生成的图片是否真实的概率</strong>，$G$ 应该希望自己生成的图片“越接近真实越好”。也就是说，$G$ 希望 $D(G(z))$ 尽可能得大，这时 $V(D, G)$ 会变小。因此我们看到式子的最前面的记号是 $\min_G$。</li>
<li>$D$ 的目的：$D$ 的能力越强，$D(x)$ 应该越大，$D(G(x))$ 应该越小。这时 $V(D,G)$ 会变大。因此式子对于 $D$ 来说是求最大 $\max_D$</li>
</ul>
<p>下面这幅图片很好地描述了这个过程：</p>
<div align=center>
<a href="https://sm.ms/image/EzTPYgcI91aVnfk" target="_blank"><img src="https://s2.loli.net/2022/04/14/EzTPYgcI91aVnfk.png" width = "400px"></a>
</div>
<h2 id="algorithm">Algorithm</h2>
<p><em><strong>Step 1</strong></em>: Fix generator $G$, and update discriminator $D$. Discriminator learns to assign high scores to real objects and low scores to generated objects.</p>
<ul>
<li>Sample $m$ examples $\{ x^1, x^2, &hellip; , x^m \}$ from database</li>
<li>Sample $m$ noise samples $\{z^1, z^2, &hellip; , z^m\}$ from a distribution</li>
<li>Obtaining generated data $\{\tilde{x}^1,\tilde{x}^2,&hellip;,\tilde{x}^m\},\tilde{x}^i=G(z^i)$</li>
<li>Update discriminator parameters $\theta_d$ to maximize $$\tilde{V}=\frac{1}{m}\sum_{i=1}^m\log D(x^i)+\frac{1}{m}\sum_{i=1}^m \log \left(1-D(\tilde{x}^i)\right)$$$$\theta_d\leftarrow \theta_d+\eta\nabla\tilde{V}(\theta_d)$$</li>
</ul>
<p><em><strong>Step 2</strong></em>: Fix discriminator $D$, and update generator $G$. Generator learns to “fool” the discriminator</p>
<ul>
<li>Sample m noise samples $\{z^1, z^2, &hellip; , z^m\}$ from a distribution</li>
<li>Update generator parameters $\theta_g$ to maximize $$\tilde{V}=\frac{1}{m}\sum_{i=1}^m\log \left(D(G(z^i))\right)$$$$\theta_g\leftarrow \theta_g-\eta\nabla\tilde{V}(\theta_g)$$</li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/24767059">GAN学习指南：从原理入门到制作生成Demo</a></li>
</ul>

    
  </article>
  <div class="paginator">
    
    <a class="link" href="https://preminstrel.github.io/blog/post/2021/11/04/zybo-z7-basics-4/">← prev</a>
    
    
    <a class="link" href="https://preminstrel.github.io/blog/post/2022/01/09/cyclegan/">next →</a>
    
  </div>
  <div class="comment">
    
    
    
    
    
    
  </div>
  
</main>

    <footer id="footer">
  <div>
    <span>© 2021</span> - <span>2022</span>
  </div>
  <div class="footnote">
    <span>Follow me on <a class=link href=https://github.com/preminstrel>GitHub</a>,
<a class=link href=https://twitter.com/preminstrel>Twitter</a> or
<a class=link href=/index.xml>RSS</a> |
<a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a>
</span>
  </div>
</footer>

  </div>

  
  

  
  

  
  

</body>

</html>
