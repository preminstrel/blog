<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  
  <meta name="author" content="Hanshi Sun">

  
  
  <meta name="description" content="æœ€è¿‘ç§‘ç ”è¦ç”¨åˆ° CycleGANï¼Œå€Ÿæ­¤æœºä¼šï¼Œä¾¿å¯¹ GAN(Generative Adversarial Networks) è¿›è¡Œä¸€ä¸ªå­¦ä¹ ã€‚Ian Goodfellow å¤§ç‰›çš„ Generative Adversarial Networksï¼ˆarxivï¼šhttps://arxiv">
  

  
  <link rel="icon" href="https://preminstrel.github.io/blog/favicon.ico">

  
  
  <meta name="keywords" content=" hugo  latex  theme ">
  

  
  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css"
  integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
  integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js"
  integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '\\[', right: '\\]', display: true },
        { left: '$', right: '$', display: false },
        { left: '\\(', right: '\\)', display: false }
      ],
      ignoredTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'option'],
      throwOnError: false
    });
  });
</script>


  

  
  <meta property="og:title" content="Introduction to GAN" />
<meta property="og:description" content="æœ€è¿‘ç§‘ç ”è¦ç”¨åˆ° CycleGANï¼Œå€Ÿæ­¤æœºä¼šï¼Œä¾¿å¯¹ GAN(Generative Adversarial Networks) è¿›è¡Œä¸€ä¸ªå­¦ä¹ ã€‚Ian Goodfellow å¤§ç‰›çš„ Generative Adversarial Networksï¼ˆarxivï¼šhttps://arxiv" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://preminstrel.github.io/blog/post/2022/01/06/introduction-to-gan/" />
<meta property="article:published_time" content="2022-01-06T23:12:33+08:00" />
<meta property="article:modified_time" content="2022-01-09T00:00:00+00:00" />


  
  <link rel="canonical" href="https://preminstrel.github.io/blog/post/2022/01/06/introduction-to-gan/">

  
  
  <meta itemprop="name" content="Introduction to GAN">
<meta itemprop="description" content="æœ€è¿‘ç§‘ç ”è¦ç”¨åˆ° CycleGANï¼Œå€Ÿæ­¤æœºä¼šï¼Œä¾¿å¯¹ GAN(Generative Adversarial Networks) è¿›è¡Œä¸€ä¸ªå­¦ä¹ ã€‚Ian Goodfellow å¤§ç‰›çš„ Generative Adversarial Networksï¼ˆarxivï¼šhttps://arxiv">
<meta itemprop="datePublished" content="2022-01-06T23:12:33&#43;08:00" />
<meta itemprop="dateModified" content="2022-01-09T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1063">



<meta itemprop="keywords" content="GAN,Deep Learning," />

  
  <link media="screen" rel="stylesheet" href='https://preminstrel.github.io/blog/css/common.css'>
  <link media="screen" rel="stylesheet" href='https://preminstrel.github.io/blog/css/content.css'>

  
  
  <title>Introduction to GAN - Blog de Preminstrel</title>
  

  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction to GAN"/>
<meta name="twitter:description" content="æœ€è¿‘ç§‘ç ”è¦ç”¨åˆ° CycleGANï¼Œå€Ÿæ­¤æœºä¼šï¼Œä¾¿å¯¹ GAN(Generative Adversarial Networks) è¿›è¡Œä¸€ä¸ªå­¦ä¹ ã€‚Ian Goodfellow å¤§ç‰›çš„ Generative Adversarial Networksï¼ˆarxivï¼šhttps://arxiv"/>


  
<link rel="stylesheet" href='https://preminstrel.github.io/blog/css/single.css'>

</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://preminstrel.github.io/blog/">Blog de Preminstrel</a>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      <a class="link" href="/blog/">Post</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/blog/post/">Archives</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/blog/about/">About</a>
    </span>
    
  </nav>
</header>

    
<main id="main" class="post">
  
  
  <h1>Introduction to GAN</h1>
  
  <div>
    <b>Keywords: </b>
    
    <a class="link" href='https://preminstrel.github.io/blog/tags/gan'>#GAN</a>
    
    <a class="link" href='https://preminstrel.github.io/blog/tags/deep-learning'>#Deep Learning</a>
    
  </div>
  
  
  <article class="content">
    
    <p>æœ€è¿‘ç§‘ç ”è¦ç”¨åˆ° CycleGANï¼Œå€Ÿæ­¤æœºä¼šï¼Œä¾¿å¯¹ <em><strong>GAN(Generative Adversarial Networks)</strong></em> è¿›è¡Œä¸€ä¸ªå­¦ä¹ ã€‚Ian Goodfellow å¤§ç‰›çš„ Generative Adversarial Networksï¼ˆarxivï¼š<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/abs/1406.2661">https://arxiv.org/abs/1406.2661</a>ï¼‰ï¼Œæ˜¯è¿™ä¸ªé¢†åŸŸçš„å¼€å¤©è¾Ÿåœ°ä¹‹ä½œã€‚å°±åƒ Yann LeCun æ‰€è¯´çš„ï¼ŒAdversarial training is the coolest thing since sliced bread.</p>
<h1 id="basic-theory">Basic Theory</h1>
<p>è¿™é‡Œç”¨ç”Ÿæˆå›¾ç‰‡ä¸ºä¾‹å¯¹GANçš„åŸç†è¿›è¡Œè¯´æ˜ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªç½‘ç»œï¼Œ<em><strong>G(Generator)</strong></em> å’Œ <em><strong>D(Discriminator)</strong></em>ï¼Œå®ƒä»¬çš„åŠŸèƒ½åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>$G$ æ˜¯ä¸€ä¸ªç”Ÿæˆå›¾ç‰‡çš„ç½‘ç»œï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªéšæœºçš„å™ªå£° $z$ï¼Œé€šè¿‡è¿™ä¸ªå™ªå£°ç”Ÿæˆå›¾ç‰‡ï¼Œè®°åš $G(z)$ã€‚å…¶è¾“å‡ºæ˜¯ä¸€ä¸ª vectorã€‚</li>
<li>$D$ æ˜¯ä¸€ä¸ªåˆ¤åˆ«ç½‘ç»œï¼Œåˆ¤åˆ«ä¸€å¼ å›¾ç‰‡æ˜¯ä¸æ˜¯â€œçœŸå®çš„â€ã€‚å®ƒçš„è¾“å…¥å‚æ•°æ˜¯ $x$ï¼Œ$x$ ä»£è¡¨ä¸€å¼ å›¾ç‰‡ï¼Œè¾“å‡º $D(x)$ ä»£è¡¨ $x$ ä¸ºçœŸå®å›¾ç‰‡çš„æ¦‚ç‡ï¼Œå¦‚æœä¸º 1ï¼Œå°±ä»£è¡¨ 100% æ˜¯çœŸå®çš„å›¾ç‰‡ï¼Œè€Œè¾“å‡ºä¸º 0ï¼Œå°±ä»£è¡¨ä¸å¯èƒ½æ˜¯çœŸå®çš„å›¾ç‰‡ã€‚å…¶è¾“å‡ºæ˜¯ä¸€ä¸ª scalarã€‚</li>
</ul>
<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œ<strong>ç”Ÿæˆç½‘ç»œ $G$ çš„ç›®æ ‡å°±æ˜¯å°½é‡ç”ŸæˆçœŸå®çš„å›¾ç‰‡å»æ¬ºéª—åˆ¤åˆ«ç½‘ç»œ $D$ã€‚è€Œ $D$ çš„ç›®æ ‡å°±æ˜¯å°½é‡æŠŠ $G$ ç”Ÿæˆçš„å›¾ç‰‡å’ŒçœŸå®çš„å›¾ç‰‡åˆ†åˆ«å¼€æ¥ã€‚</strong> è¿™æ ·ï¼Œ$G$ å’Œ $D$ æ„æˆäº†ä¸€ä¸ªåŠ¨æ€çš„â€œåšå¼ˆè¿‡ç¨‹â€ã€‚æœ€ååšå¼ˆçš„ç»“æœæ˜¯ï¼š<strong>åœ¨æœ€ç†æƒ³çš„çŠ¶æ€ä¸‹ï¼Œ</strong> $G$ å¯ä»¥ç”Ÿæˆè¶³ä»¥â€œä»¥å‡ä¹±çœŸâ€çš„å›¾ç‰‡ $G(z)$ã€‚å¯¹äº $D$ æ¥è¯´ï¼Œå®ƒéš¾ä»¥åˆ¤å®š $G$ ç”Ÿæˆçš„å›¾ç‰‡ç©¶ç«Ÿæ˜¯ä¸æ˜¯çœŸå®çš„ï¼Œå› æ­¤ $D(G(z)) = 0.5$ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸåœ°å¾—åˆ°äº†ä¸€ä¸ªç”Ÿæˆå¼çš„æ¨¡å‹ $G$ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç”Ÿæˆå›¾ç‰‡ã€‚</p>
<div align=center>
<img src="/img/20220109125533.png" width="500px"/>
</div>
<h1 id="formula">Formula</h1>
<p>ä»¥ä¸Šåªæ˜¯å¤§è‡´è¯´äº†ä¸€ä¸‹ GAN çš„æ ¸å¿ƒåŸç†ï¼Œå¦‚ä½•ç”¨æ•°å­¦è¯­è¨€æè¿°å‘¢ï¼Ÿè¿™é‡Œç›´æ¥æ‘˜å½•è®ºæ–‡é‡Œçš„å…¬å¼ï¼š</p>
<p>$$\min_{G} \max_{D} V(D, G)=\mathbb{E}_{\boldsymbol{x} \sim p_{\text {data }}(\boldsymbol{x})}[\log D(\boldsymbol{x})]+\mathbb{E}_{\boldsymbol{z} \sim p_{\boldsymbol{z}}(\boldsymbol{z})}[\log (1-D(G(\boldsymbol{z})))]$$</p>
<p>å…¬å¼ä¸­ï¼š</p>
<ul>
<li>æ•´ä¸ªå¼å­ç”±ä¸¤é¡¹æ„æˆã€‚$x$ è¡¨ç¤ºçœŸå®å›¾ç‰‡ï¼Œ$z$  è¡¨ç¤ºè¾“å…¥ $G$ ç½‘ç»œçš„å™ªå£°ï¼Œè€Œ $G(z)$ è¡¨ç¤º $G$ ç½‘ç»œç”Ÿæˆçš„å›¾ç‰‡ã€‚</li>
<li>$D(x)$ è¡¨ç¤º $D$ ç½‘ç»œåˆ¤æ–­<strong class=chinese>çœŸå®å›¾ç‰‡æ˜¯å¦çœŸå®</strong>çš„æ¦‚ç‡ï¼ˆå› ä¸º $x$ å°±æ˜¯çœŸå®çš„ï¼Œæ‰€ä»¥å¯¹äº $D$ æ¥è¯´ï¼Œè¿™ä¸ªå€¼è¶Šæ¥è¿‘ 1 è¶Šå¥½ï¼‰ã€‚è€Œ $D(G(z))$ æ˜¯ <strong>$D$ ç½‘ç»œåˆ¤æ–­ $G$ ç”Ÿæˆçš„å›¾ç‰‡çš„æ˜¯å¦çœŸå®çš„æ¦‚ç‡ã€‚</strong></li>
<li>$G$ çš„ç›®çš„ï¼šä¸Šé¢æåˆ°è¿‡ï¼Œ$D(G(z))$ æ˜¯<strong>$D$ ç½‘ç»œåˆ¤æ–­ $G$ ç”Ÿæˆçš„å›¾ç‰‡æ˜¯å¦çœŸå®çš„æ¦‚ç‡</strong>ï¼Œ$G$ åº”è¯¥å¸Œæœ›è‡ªå·±ç”Ÿæˆçš„å›¾ç‰‡â€œè¶Šæ¥è¿‘çœŸå®è¶Šå¥½â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ$G$ å¸Œæœ› $D(G(z))$ å°½å¯èƒ½å¾—å¤§ï¼Œè¿™æ—¶ $V(D, G)$ ä¼šå˜å°ã€‚å› æ­¤æˆ‘ä»¬çœ‹åˆ°å¼å­çš„æœ€å‰é¢çš„è®°å·æ˜¯ $\min_G$ã€‚</li>
<li>$D$ çš„ç›®çš„ï¼š$D$ çš„èƒ½åŠ›è¶Šå¼ºï¼Œ$D(x)$ åº”è¯¥è¶Šå¤§ï¼Œ$D(G(x))$ åº”è¯¥è¶Šå°ã€‚è¿™æ—¶ $V(D,G)$ ä¼šå˜å¤§ã€‚å› æ­¤å¼å­å¯¹äº $D$ æ¥è¯´æ˜¯æ±‚æœ€å¤§ $\max_D$</li>
</ul>
<p>ä¸‹é¢è¿™å¹…å›¾ç‰‡å¾ˆå¥½åœ°æè¿°äº†è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<div align=center>
<img src="/img/20220106234555.png" width="400px"/>
</div>
<h1 id="algorithm">Algorithm</h1>
<p><em><strong>Step 1</strong></em>: Fix generator $G$, and update discriminator $D$. Discriminator learns to assign high scores to real objects and low scores to generated objects.</p>
<ul>
<li>Sample $m$ examples $\{ x^1, x^2, &hellip; , x^m \}$ from database</li>
<li>Sample $m$ noise samples $\{z^1, z^2, &hellip; , z^m\}$ from a distribution</li>
<li>Obtaining generated data $\{\tilde{x}^1,\tilde{x}^2,&hellip;,\tilde{x}^m\},\tilde{x}^i=G(z^i)$</li>
<li>Update discriminator parameters $\theta_d$ to maximize $$\tilde{V}=\frac{1}{m}\sum_{i=1}^m\log D(x^i)+\frac{1}{m}\sum_{i=1}^m \log \left(1-D(\tilde{x}^i)\right)$$$$\theta_d\leftarrow \theta_d+\eta\nabla\tilde{V}(\theta_d)$$</li>
</ul>
<p><em><strong>Step 2</strong></em>: Fix discriminator $D$, and update generator $G$. Generator learns to â€œfoolâ€ the discriminator</p>
<ul>
<li>Sample m noise samples $\{z^1, z^2, &hellip; , z^m\}$ from a distribution</li>
<li>Update generator parameters $\theta_g$ to maximize $$\tilde{V}=\frac{1}{m}\sum_{i=1}^m\log \left(D(G(z^i))\right)$$$$\theta_g\leftarrow \theta_g-\eta\nabla\tilde{V}(\theta_g)$$</li>
</ul>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/24767059">GANå­¦ä¹ æŒ‡å—ï¼šä»åŸç†å…¥é—¨åˆ°åˆ¶ä½œç”ŸæˆDemo</a></li>
</ul>

    
  </article>
  <div class="paginator">
    
    <a class="link" href="https://preminstrel.github.io/blog/post/2021/11/04/zybo-z7-basics-4/">â† prev</a>
    
    
    <a class="link" href="https://preminstrel.github.io/blog/post/2022/01/09/cyclegan/">next â†’</a>
    
  </div>
  <div class="comment">
    
    
    
    
    
    
  </div>
  
</main>

    <footer id="footer">
  <div>
    <span>Â© 2021</span> - <span>2022</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" href="https://gohugo.io/">Hugo</a>
    <span> ğŸ¦ Theme </span>
    <a class="link" href="https://github.com/queensferryme/hugo-theme-texify">TeXify</a>
  </div>

  <div class="footnote">
    <span>Follow me on <a class=link href=https://github.com/preminstrel>GitHub</a>,
<a class=link href=https://twitter.com/preminstrel>Twitter</a> or
<a class=link href=/index.xml>RSS</a> |
<a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a>
</span>
  </div>
</footer>

  </div>

  
  

  
  

  
  

</body>

</html>
